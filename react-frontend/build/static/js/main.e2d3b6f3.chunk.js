(this["webpackJsonpreact-frontend"]=this["webpackJsonpreact-frontend"]||[]).push([[0],{52:function(t,e,n){},66:function(t,e,n){},69:function(t,e,n){},70:function(t,e,n){"use strict";n.r(e);var i,a,r,s,c,o,u,l,d,f,j,b=n(0),h=n(26),O=n.n(h),p=(n(52),n(4)),m=n(20),y=n(17),g=n(6),x=n(11),v=n(12),S=n(1),w=v.a.div(i||(i=Object(x.a)(["\n    color : white;\n    font-size: 6vw;\n    font-family: 'Mulish', sans-serif;\n    font-weight: 700;\n"]))),E=Object(v.b)(a||(a=Object(x.a)(["\n    0% { width: 0 }\n    20% { width: 0% }\n    30% { width: 100% }\n    70% { width: 100% }\n    80% { width: 0 }\n    100% { width: 0 }\n"]))),T=Object(v.b)(r||(r=Object(x.a)(["\n    from, to { border-color: transparent }\n    50% { border-color: #11FD4C; }\n"]))),N=v.a.div(s||(s=Object(x.a)(["\n    display: inline-block;\n    color : white;\n    font-size: 6vw;\n    font-family: 'Mulish', sans-serif;\n    font-weight: 700;\n\n    overflow: hidden; /* Ensures the content is not revealed until the animation */\n    border-right: .15em solid #11FD4C; /* The typwriter cursor */\n    white-space: nowrap; /* Keeps the content on a single line */\n\n    margin: 0 auto; /* Gives that scrolling effect as the typing happens */\n    animation: \n        "," 5s steps(15, end) infinite,\n        "," .75s step-end infinite;\n"])),E,T),P=v.a.div(c||(c=Object(x.a)(["\n    width: max-content;\n"]))),L=v.a.div(o||(o=Object(x.a)(["\n    margin: 3em;\n"]))),k=v.a.div(u||(u=Object(x.a)(["\n    padding: 1em;\n    margin-top: 1em;\n    margin-left: 50%;\n    transform: translate(-50%);\n\n    font-family: 'Mulish', sans-serif;\n    font-weight: 700;\n    font-size: 2vw;    \n    color: white;\n    \n    border: 7px solid;\n    border-color: white;\n    width: max-content;\n"]))),_=function(t){var e=t.handleLogin,n=Object(b.useState)(0),i=Object(p.a)(n,2),a=i[0],r=i[1],s=["K-means","Mean Shift","Affinity Propagation"];return Object(b.useEffect)((function(){setTimeout((function(){r(a<s.length-1?a+1:0)}),5e3)}),[a]),Object(S.jsxs)(L,{children:[Object(S.jsx)(w,{children:"Find clusters in your Spotify playlists using..."}),Object(S.jsx)(P,{children:Object(S.jsx)(N,{children:s[a]})}),Object(S.jsx)(k,{onClick:e,children:"Login"})]})},D=v.a.div(l||(l=Object(x.a)(["\n    display: grid;\n    grid-template-columns: 50% 50%;\n"]))),C=v.a.div(d||(d=Object(x.a)(["\n    grid-row-start: 1;\n    grid-column-start: 1;\n    /* padding: 1em;\n    margin-top: 3em; */\n"]))),I=v.a.img(f||(f=Object(x.a)(["\n    object-fit: cover;\n    width: 100%;\n    max-height: 100%;\n    margin-left: 50%;\n    transform: translate(-50%);\n    padding: 1em;\n"]))),z=v.a.div(j||(j=Object(x.a)(["\n    grid-row-start: 1;\n    grid-column-start: 2;\n    margin-top: 5em;\n    padding: 1em;\n    color: white;\n"]))),M=function(t){var e=t.images,n=t.selectPlaylist,i=t.userInfo,a=(t.ids,t.titles),r=t.artists,s=t.features,c=t.TSNEfeatures,o=t.playlistList,u=t.selectedPlaylist,l=t.setSelectPlaylistId,d={dataPointLabels:r.map((function(t,e){return"".concat(t," - ").concat(a[e])})),TSNE_features:c,features:s},f=Object(g.g)();return Object(S.jsxs)(D,{children:[Object(S.jsx)(C,{children:e.map((function(t,e){return Object(S.jsx)(I,{src:t,alt:"Playlist cover",onClick:function(){n(o.map((function(t){return t.id}))[e]),l(o.map((function(t){return t.id}))[e])}},e)}))}),Object(S.jsxs)(z,{children:[Object(S.jsxs)("h1",{children:["Hi, ",i.display_name]}),Object(S.jsx)("p",{children:"Tap a playlist to fetch its data"}),Object(S.jsxs)("p",{children:["Playlist length: ",a.length]}),Object(S.jsx)("button",{onClick:function(){f.push({pathname:"playlists/".concat(u),data:d})},children:"Plot"})]})]})},K=function(t){var e=t.authenticated,n=t.userInfo,i=t.playlistList,a=t.selectPlaylist,r=t.titles,s=t.features,c=t.TSNEfeatures,o=t.ids,u=t.artists,l=t.selectedPlaylist,d=t.setSelectPlaylistId,f=t.getLabels,j=i.map((function(t){return t.images[0].url}));return e?Object(S.jsx)(M,{images:j,selectPlaylist:a,userInfo:n,titles:r,artists:u,features:s,ids:o,playlistList:i,selectedPlaylist:l,setSelectPlaylistId:d,TSNEfeatures:c,getLabels:f}):Object(S.jsx)(g.a,{to:"/login"})},X=n(47),Y=n.n(X);function J(){var t=window;return{width:t.innerWidth,height:t.innerHeight}}var B,F=function(t){var e=t.data,n=t.labels,i=t.Xdim,a=t.Ydim,r=t.Zdim,s=function(){var t=Object(b.useState)(J()),e=Object(p.a)(t,2),n=e[0],i=e[1];return Object(b.useEffect)((function(){function t(){i(J())}return window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}),[]),n}(),c=s.height,o=s.width,u={tick0:0,tickcolor:"#D3D3D3",tickwidth:2,gridcolor:"#D3D3D3",gridwidth:2,zerolinecolor:"#D3D3D3",zerolinewidth:2};return Object(S.jsx)(Y.a,{config:{displayModeBar:!1},data:[{x:i,y:a,z:r,type:"scatter3d",mode:"markers",marker:{color:n,symbol:"circle"},hoverlabel:{bgcolor:"grey"},hoverinfo:"text",text:e.dataPointLabels}],layout:{displayModeBar:!1,margin:{pad:20},width:o,height:c,paper_bgcolor:"black",scene:{aspectmode:"auto",yaxis:u,xaxis:u,zaxis:u}}})},Z=n.p+"static/media/demo-loader.67b2533e.svg",A=v.a.div(B||(B=Object(x.a)(["\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n"]))),H=function(){return Object(S.jsx)(A,{children:Object(S.jsx)("object",{type:"image/svg+xml",data:Z,children:"svg-animation"})})},G=(n(66),n(67),n(41)),W=n(31),q=n(32),Q=function(t){var e=t.getLabels,n=t.labels,i={TSNE1:{array:"TSNE_features",index:0},TSNE2:{array:"TSNE_features",index:1},TSNE3:{array:"TSNE_features",index:2},acousticness:{array:"features",index:0},danceability:{array:"features",index:1},energy:{array:"features",index:2},instrumentalness:{array:"features",index:3},liveness:{array:"features",index:4},loudness:{array:"features",index:5},speechiness:{array:"features",index:6},tempo:{array:"features",index:7},valence:{array:"features",index:8}},a=Object(b.useState)([]),r=Object(p.a)(a,2),s=r[0],c=r[1],o=Object(b.useState)([]),u=Object(p.a)(o,2),l=u[0],d=u[1],f=Object(b.useState)([]),j=Object(p.a)(f,2),h=j[0],O=j[1],m=Object(b.useState)([]),y=Object(p.a)(m,2),x=y[0],v=y[1],w=Object(b.useState)("TSNE1"),E=Object(p.a)(w,2),T=E[0],N=E[1],P=Object(b.useState)("TSNE2"),L=Object(p.a)(P,2),k=L[0],_=L[1],D=Object(b.useState)("TSNE3"),C=Object(p.a)(D,2),I=C[0],z=C[1],M=Object(g.h)();Object(b.useEffect)((function(){c(M.data),d(M.data.TSNE_features.map((function(t){return t[0]}))),O(M.data.TSNE_features.map((function(t){return t[1]}))),v(M.data.TSNE_features.map((function(t){return t[2]})))}),[M.data,s]);var K=function(t){return"X axis"===t?T:"Y axis"===t?k:I};return void 0===s.TSNE_features?Object(S.jsx)(H,{}):Object(S.jsxs)("div",{children:[Object(S.jsxs)("div",{className:"buttonContainer",children:[["X axis","Y axis","Z axis"].map((function(t,e){return Object(S.jsxs)("div",{style:{color:"white"},children:[t,Object(S.jsx)(G.a,{title:K(t),children:Object.entries(i).map((function(e){var n=Object(p.a)(e,2),i=n[0],a=n[1];return Object(S.jsx)("div",{children:Object(S.jsx)(W.a.Item,{eventKey:i,onClick:function(){!function(t,e,n){"X axis"===t?(d(s[e.array].map((function(t){return t[e.index]}))),N(n)):"Y axis"===t?(O(s[e.array].map((function(t){return t[e.index]}))),_(n)):(v(s[e.array].map((function(t){return t[e.index]}))),z(n))}(t,a,i)},children:i})},i)}))})]},e)})),Object(S.jsx)(G.a,{title:"Model Selector",children:Object.keys({"K-means":{params:{n_clusters:0}},"Affinity Propagation":{params:{max_iter:5e3,convergence_iter:150}},"Mean Shift":{params:{n_jobs:-1}}}).map((function(t,n){return Object(S.jsx)(q.a,{eventKey:t,onClick:function(){return e(t)},children:t},n)}))})]}),Object(S.jsx)(F,{data:s,labels:n,Xdim:l,Ydim:h,Zdim:x})]})},R=(n(69),function(t){var e=t.loading,n=t.showLoading,i=t.hideLoading,a=Object(b.useState)(!1),r=Object(p.a)(a,2),s=r[0],c=r[1],o=Object(b.useState)([]),u=Object(p.a)(o,2),l=u[0],d=u[1],f=Object(b.useState)({}),j=Object(p.a)(f,2),h=j[0],O=j[1],m=Object(b.useState)([]),x=Object(p.a)(m,2),v=x[0],w=x[1],E=Object(b.useState)([]),T=Object(p.a)(E,2),N=T[0],P=T[1],L=Object(b.useState)([]),k=Object(p.a)(L,2),D=k[0],C=k[1],I=Object(b.useState)(""),z=Object(p.a)(I,2),M=z[0],X=z[1],Y=Object(b.useState)([]),J=Object(p.a)(Y,2),B=J[0],F=J[1],Z=Object(b.useState)([]),A=Object(p.a)(Z,2),G=A[0],W=A[1],q=Object(b.useState)([]),R=Object(p.a)(q,2),U=R[0],V=R[1];Object(b.useEffect)((function(){fetch("/spotify/is-authenticated").then((function(t){return t.json()})).then((function(t){console.log("authentication status: ".concat(t.status)),c(t.status),i()}))}),[]),Object(b.useEffect)((function(){s&&(fetch("/spotify/playlists").then((function(t){return t.json()})).then((function(t){var e=t.playlists.items.map((function(t){return t.id}));C(e),d(t.playlists.items)})),fetch("/spotify/user-profile").then((function(t){return t.json()})).then((function(t){O(t.user_profile),i()})))}),[s]);var $=function(t){n(),fetch("/spotify/get-labels",{method:"POST",headers:{"Content-Type":"application/json",Model:t},body:JSON.stringify(B)}).then((function(t){return t.json()})).then((function(t){V(t),i()}))},tt=Object(g.i)("/playlists/:id"),et=tt?l.find((function(t){return t.id===Number(tt.params.id)})):null;return e?Object(S.jsx)(H,{}):Object(S.jsx)("div",{children:Object(S.jsxs)(g.d,{children:[Object(S.jsx)(g.b,{path:"/playlists/:id",children:Object(S.jsx)(Q,{id:et,getLabels:$,labels:U})}),Object(S.jsx)(g.b,{path:"/login",children:Object(S.jsx)(_,{handleLogin:function(){return fetch("/spotify/is-authenticated").then((function(t){return t.json()})).then((function(t){t.status||fetch("/spotify/get-auth-url").then((function(t){return t.json()})).then((function(t){c(!0),window.location.replace(t.url)}))}))}})}),Object(S.jsx)(g.b,{path:"/",children:Object(S.jsx)(K,{authenticated:s,userInfo:h,playlistList:l,selectPlaylist:function(t){n(),w([]),P([]),F([]),W([]),C([]),V([]);var e=[];return function t(n){return fetch("/spotify/get-track-ids",{headers:{url:n}}).then((function(t){return t.json()})).then((function(n){if(console.log(n),w((function(t){return[].concat(Object(y.a)(t),Object(y.a)(n.title))})),P((function(t){return[].concat(Object(y.a)(t),Object(y.a)(n.artist))})),F((function(t){return[].concat(Object(y.a)(t),Object(y.a)(n.features))})),C((function(t){return[].concat(Object(y.a)(t),Object(y.a)(n.track_ids))})),e.push(n.features),n.next_url){var i=n.next_url.replace("https://api.spotify.com/v1","");return t(i)}return fetch("/spotify/get-dimension-reduction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.flat())}).then((function(t){return t.json()})).then((function(t){W(t)}))}))}("/playlists/".concat(t,"/tracks/?offset=0&limit=100")).then((function(){i()}))},titles:v,artists:N,features:B,TSNEfeatures:G,ids:D,selectedPlaylist:M,setSelectPlaylistId:function(t){X(t)},getLabels:$})})]})})}),U=function(){var t=Object(b.useState)(!0),e=Object(p.a)(t,2),n=e[0],i=e[1];return Object(S.jsx)(m.a,{children:Object(S.jsx)(R,{loading:n,showLoading:function(){return i(!0)},hideLoading:function(){return i(!1)}})})};O.a.render(Object(S.jsx)(U,{}),document.getElementById("root"))}},[[70,1,2]]]);
//# sourceMappingURL=main.e2d3b6f3.chunk.js.map