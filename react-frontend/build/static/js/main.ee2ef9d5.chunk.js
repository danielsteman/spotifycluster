(this["webpackJsonpreact-frontend"]=this["webpackJsonpreact-frontend"]||[]).push([[0],{104:function(t,e,n){},106:function(t,e,n){},107:function(t,e,n){"use strict";n.r(e);var a,i,r,s,c,o,l,u,d,f,h,j,b,p,O,g=n(0),m=n(22),x=n.n(m),y=(n(71),n(5)),v=n(20),w=n(19),S=n(9),k=n(6),E=n(7),T=n(1),C=E.a.div(a||(a=Object(k.a)(["\n    color : white;\n    font-size: 7vw;\n    font-family: 'Mulish', sans-serif;\n    font-weight: 700;\n"]))),L=Object(E.b)(i||(i=Object(k.a)(["\n    0% { width: 0 }\n    20% { width: 0% }\n    30% { width: 100% }\n    70% { width: 100% }\n    80% { width: 0 }\n    100% { width: 0 }\n"]))),N=Object(E.b)(r||(r=Object(k.a)(["\n    from, to { border-color: transparent }\n    50% { border-color: #11FD4C; }\n"]))),P=E.a.div(s||(s=Object(k.a)(["\n    display: inline-block;\n    color : white;\n    font-size: 7vw;\n    font-family: 'Mulish', sans-serif;\n    font-weight: 700;\n\n    overflow: hidden; /* Ensures the content is not revealed until the animation */\n    border-right: .15em solid #11FD4C; /* The typwriter cursor */\n    white-space: nowrap; /* Keeps the content on a single line */\n\n    margin: 0 auto; /* Gives that scrolling effect as the typing happens */\n    animation: \n        "," 5s steps(15, end) infinite,\n        "," .75s step-end infinite;\n"])),L,N),_=E.a.div(c||(c=Object(k.a)(["\n    width: max-content;\n"]))),I=E.a.div(o||(o=Object(k.a)(["\n    margin: 3em;\n"]))),z=E.a.button(l||(l=Object(k.a)(["\n    padding: 1em;\n    margin-top: 1em;\n    margin-left: 50%;\n    transform: translate(-50%);\n\n    font-family: 'Mulish', sans-serif;\n    font-weight: 700;\n    font-size: 3vw;    \n    color: white;\n    \n    border: 7px solid;\n    border-color: white;\n    background-color: black;\n    width: max-content;\n\n    @media screen and (max-width: 500px) {\n        margin-top: 12em;\n    }\n"]))),M=function(t){var e=t.login,n=Object(g.useState)(0),a=Object(y.a)(n,2),i=a[0],r=a[1],s=["K-means","Mean Shift","Affinity Propagation"];return Object(g.useEffect)((function(){setTimeout((function(){r(i<s.length-1?i+1:0)}),5e3)}),[i]),Object(T.jsxs)(I,{children:[Object(T.jsx)(C,{children:"Find clusters in your Spotify playlists using..."}),Object(T.jsx)(_,{children:Object(T.jsx)(P,{children:s[i]})}),Object(T.jsx)(z,{onClick:function(){e()},children:"Login"})]})},D=function(t){return t.filter((function(e,n){return t.indexOf(e)===n}))},B=E.a.div(u||(u=Object(k.a)(["\n    display: grid;\n    grid-template-columns: 50% 50%;\n"]))),K=E.a.div(d||(d=Object(k.a)(["\n    padding: 1em;\n    grid-row-start: 1;\n    grid-column-start: 1;\n"]))),X=E.a.img(f||(f=Object(k.a)(["\n    object-fit: cover;\n    width: 100%;\n    max-height: 100%;\n    margin-left: 50%;\n    transform: translate(-50%);\n    padding: 2vw 6vw;\n    @media screen and (min-width: 1025px) {\n        padding: 2vw 12vw;\n    }\n"]))),Y=E.a.div(h||(h=Object(k.a)(["\n    grid-row-start: 1;\n    grid-column-start: 2;\n    position: sticky;\n    top: 0;\n    height: 100vh;\n    padding: calc(1em + 2vh);\n    color: white;\n"]))),F=E.a.div(j||(j=Object(k.a)(["\n    font-family: 'Mulish', sans-serif;\n    font-weight: 700;\n    font-size: 4vw;    \n    color: white;\n"]))),J=E.a.div(b||(b=Object(k.a)(["\n    margin: 2vw 0;\n\n    font-family: 'Mulish', sans-serif;\n    font-style: italic;\n    font-weight: 300;\n    font-size: 2vw;    \n    color: white;\n"]))),W=E.a.div(p||(p=Object(k.a)(["\n    font-family: 'Mulish', sans-serif;\n    font-weight: 300;\n    font-size: 2vw;    \n    color: white;\n"]))),H=E.a.button(O||(O=Object(k.a)(["\n    padding: 1em;\n    margin-top: 5em;\n\n    font-family: 'Mulish', sans-serif;\n    font-weight: 700;\n    font-size: 2vw;\n    color: white;\n    \n    border: 7px solid;\n    border-color: white;\n    background-color: black;\n    width: max-content;\n"]))),Z=function(t){var e=t.images,n=t.selectPlaylist,a=t.userInfo,i=t.titles,r=t.artists,s=t.features,c=t.TSNEfeatures,o=t.playlistList,l=t.selectedPlaylist,u=t.setSelectPlaylistId,d={dataPointLabels:r.map((function(t,e){return"".concat(t," - ").concat(i[e])})),TSNE_features:c,features:s,userId:a.id},f=Object(S.g)();return Object(T.jsxs)(B,{children:[Object(T.jsx)(K,{children:e.map((function(t,e){return Object(T.jsx)(X,{src:t,alt:"Playlist cover",onClick:function(){n(o.map((function(t){return t.id}))[e]),u(o.map((function(t){return t.id}))[e])}},e)}))}),Object(T.jsxs)(Y,{children:[Object(T.jsxs)(F,{children:["Hi, ",a.display_name]}),Object(T.jsx)(J,{children:"Click on a playlist cover to fetch its data"}),i.length>0&&Object(T.jsxs)("div",{children:[Object(T.jsxs)(W,{children:["No. of songs: ",i.length]}),Object(T.jsxs)(W,{children:["No. of artists: ",D(r).length]}),c.length>0&&Object(T.jsx)(H,{onClick:function(){f.push({pathname:"playlists/".concat(l),data:d})},children:"Plot"})]})]})]})},A=function(t){var e=t.authenticated,n=t.userInfo,a=t.playlistList,i=t.selectPlaylist,r=t.titles,s=t.features,c=t.TSNEfeatures,o=t.ids,l=(t.uris,t.artists),u=t.selectedPlaylist,d=t.setSelectPlaylistId,f=t.getLabels,h=(t.labels,a.map((function(t){return t.images[0]?t.images[0].url:""})));return e?Object(T.jsx)(Z,{images:h,selectPlaylist:i,userInfo:n,titles:r,artists:l,features:s,ids:o,playlistList:a,selectedPlaylist:u,setSelectPlaylistId:d,TSNEfeatures:c,getLabels:f}):Object(T.jsx)(S.a,{to:"/login"})},G=n(66),U=n.n(G);function V(){var t=window;return{width:t.innerWidth,height:t.innerHeight}}var q,Q,R,$,tt,et,nt=function(t){var e=t.data,n=t.labels,a=t.Xdim,i=t.Ydim,r=t.Zdim,s=function(){var t=Object(g.useState)(V()),e=Object(y.a)(t,2),n=e[0],a=e[1];return Object(g.useEffect)((function(){function t(){a(V())}return window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}),[]),n}(),c=s.height,o=s.width,l={tick0:0,tickcolor:"#D3D3D3",tickwidth:2,gridcolor:"#D3D3D3",gridwidth:2,zerolinecolor:"#D3D3D3",zerolinewidth:2};return Object(T.jsx)(U.a,{style:{transform:"scale(1.3)"},config:{displayModeBar:!1},data:[{x:a,y:i,z:r,type:"scatter3d",mode:"markers",marker:{color:n,symbol:"circle"},hoverlabel:{bgcolor:"grey"},hoverinfo:"text",text:e.dataPointLabels}],layout:{displayModeBar:!1,margin:{pad:20},width:o,height:c,paper_bgcolor:"black",scene:{aspectmode:"auto",yaxis:l,xaxis:l,zaxis:l}}})},at=n.p+"static/media/loading_animation_v1.2dd379a5.svg",it=E.a.object(q||(q=Object(k.a)(["\n    height: 15vh;\n    width: 15vh;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%); \n    position: fixed;\n    text-align: center;\n"]))),rt=E.a.div(Q||(Q=Object(k.a)(["\n    top: 60%;\n    left: 50%;\n    transform: translate(-50%);\n    font-size: 1.5vh;\n    position: absolute;\n    color: white;\n    font-weight: 700;\n"]))),st=function(t){var e=t.loadingCaption;return Object(T.jsxs)("div",{children:[Object(T.jsx)(it,{type:"image/svg+xml",data:at,children:"svg-animation"}),Object(T.jsx)(rt,{children:e})]})},ct=n(15),ot=n.n(ct),lt=n(23),ut=n(43),dt=n(21),ft=(n(85),n(50)),ht=n.n(ft),jt=function(t,e){for(var n=Math.ceil(t.length/e),a=[],i=0;i<n;i++){var r=t.slice(i*e,e+i*e);a.push(r)}return a},bt=function(){var t=Object(lt.a)(ot.a.mark((function t(e,n,a){var i,r,s;return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={"user-id":e,"new-playlist-name":n,n:a},t.prev=1,t.next=4,ht()({method:"post",url:"/spotify/generate-playlists",headers:i});case 4:return r=t.sent,t.next=7,r.data;case 7:return s=t.sent,t.abrupt("return",s);case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,n,a){return t.apply(this,arguments)}}(),pt=function(){var t=Object(lt.a)(ot.a.mark((function t(e,n){return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:[],(n.length>100?jt(n):[n]).forEach(function(){var t=Object(lt.a)(ot.a.mark((function t(n){var a,i,r;return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={"playlist-id":e,uris:n},t.prev=1,t.next=4,ht()({method:"post",url:"/spotify/fill-playlist",headers:a});case 4:return i=t.sent,t.next=7,i.data;case 7:return r=t.sent,t.abrupt("return",r);case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Ot=function(){var t=Object(lt.a)(ot.a.mark((function t(e,n,a,i){var r,s,c;return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=D(e),s=r.length,t.next=4,bt(a,i,s);case 4:c=t.sent,r.forEach(function(){var t=Object(lt.a)(ot.a.mark((function t(a,i){var r,s;return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=c[i],s=n.filter((function(t,n){return e[n]===a})),t.next=4,pt(r,s);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 6:case"end":return t.stop()}}),t)})));return function(e,n,a,i){return t.apply(this,arguments)}}(),gt=function(t){var e=t.toggleWarning,n=t.warningVisible,a=t.userId,i=t.uris,r=t.labels,s=t.showLoading,c=t.hideLoading,o=Object(S.g)();return Object(T.jsxs)(ut.a,{show:n,onClose:e,children:[Object(T.jsx)(ut.a.Header,{children:Object(T.jsx)("strong",{className:"me-auto",children:"Warning"})}),Object(T.jsxs)(ut.a.Body,{children:[Object(T.jsxs)("p",{children:["By clicking on continue, new playlists will be created for your Spotify account. Click ",Object(T.jsx)(v.b,{to:"/",children:"here"})," for more information."]}),Object(T.jsx)(dt.a,{onClick:Object(lt.a)(ot.a.mark((function t(){return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s("Creating playlists"),t.next=3,Ot(r,i,a,"cluster");case 3:c(),o.push("/result");case 5:case"end":return t.stop()}}),t)}))),children:"Continue"})]})]})},mt=(n(103),n(51)),xt=n(40),yt=n(41),vt=(n(104),E.a.div(R||(R=Object(k.a)(["\n    position: absolute;\n    z-index: 1;\n    margin-top: 2%;\n    margin-left: 5%;\n"])))),wt=E.a.div($||($=Object(k.a)(["\n    position: fixed;\n    z-index: 2;\n    height: 15vh;\n    width: 15vh;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n\n    text-align: center;\n    color: white;\n"]))),St=function(t){var e=t.getLabels,n=t.labels,a=t.uris,i=t.showLoading,r=t.hideLoading,s={TSNE1:{array:"TSNE_features",index:0},TSNE2:{array:"TSNE_features",index:1},TSNE3:{array:"TSNE_features",index:2},acousticness:{array:"features",index:0},danceability:{array:"features",index:1},energy:{array:"features",index:2},instrumentalness:{array:"features",index:3},liveness:{array:"features",index:4},loudness:{array:"features",index:5},speechiness:{array:"features",index:6},tempo:{array:"features",index:7},valence:{array:"features",index:8}},c=Object(g.useState)([]),o=Object(y.a)(c,2),l=o[0],u=o[1],d=Object(g.useState)([]),f=Object(y.a)(d,2),h=f[0],j=f[1],b=Object(g.useState)([]),p=Object(y.a)(b,2),O=p[0],m=p[1],x=Object(g.useState)([]),v=Object(y.a)(x,2),w=v[0],k=v[1],E=Object(g.useState)("TSNE1"),C=Object(y.a)(E,2),L=C[0],N=C[1],P=Object(g.useState)("TSNE2"),_=Object(y.a)(P,2),I=_[0],z=_[1],M=Object(g.useState)("TSNE3"),D=Object(y.a)(M,2),B=D[0],K=D[1],X=Object(g.useState)(!1),Y=Object(y.a)(X,2),F=Y[0],J=Y[1],W=Object(g.useState)(""),H=Object(y.a)(W,2),Z=H[0],A=H[1],G=Object(S.h)();Object(g.useEffect)((function(){u(G.data),j(G.data.TSNE_features.map((function(t){return t[0]}))),m(G.data.TSNE_features.map((function(t){return t[1]}))),k(G.data.TSNE_features.map((function(t){return t[2]}))),A(l.userId)}),[G.data,l]);var U=function(t){return"X axis"===t?L:"Y axis"===t?I:B};return void 0===l.TSNE_features?Object(T.jsx)(st,{}):Object(T.jsxs)("div",{children:[Object(T.jsxs)(vt,{children:[["X axis","Y axis","Z axis"].map((function(t,e){return Object(T.jsx)("div",{style:{color:"white"},children:Object(T.jsx)(mt.a,{title:U(t),children:Object.entries(s).map((function(e){var n=Object(y.a)(e,2),a=n[0],i=n[1];return Object(T.jsx)("div",{children:Object(T.jsx)(xt.a.Item,{eventKey:a,onClick:function(){!function(t,e,n){"X axis"===t?(j(l[e.array].map((function(t){return t[e.index]}))),N(n)):"Y axis"===t?(m(l[e.array].map((function(t){return t[e.index]}))),z(n)):(k(l[e.array].map((function(t){return t[e.index]}))),K(n))}(t,i,a)},children:a})},a)}))})},e)})),Object(T.jsx)(mt.a,{title:"Model Selector",children:Object.keys({"K-means":{params:{n_clusters:0}},"Affinity Propagation":{params:{max_iter:5e3,convergence_iter:150}},"Mean Shift":{params:{n_jobs:-1}}}).map((function(t,n){return Object(T.jsx)(yt.a,{eventKey:t,onClick:function(){e(t)},children:t},n)}))}),0!==n.length&&Object(T.jsx)(dt.a,{onClick:function(){return J(!0)},children:"Generate playlists"})]}),F&&Object(T.jsx)(wt,{children:Object(T.jsx)(gt,{toggleWarning:function(){J(!F)},warningVisible:F,userId:Z,uris:a,labels:n,showLoading:i,hideLoading:r})}),Object(T.jsx)(nt,{data:l,labels:n,Xdim:h,Ydim:O,Zdim:w})]})},kt=function(){return Object(T.jsx)("div",{children:"Page not found"})},Et=(n(106),E.a.div(tt||(tt=Object(k.a)(["\n    font-family: 'Mulish', sans-serif;\n    font-weight: 700;\n    font-size: 4vw;    \n    color: white;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%); \n    position: fixed;\n    text-align: center;\n"])))),Tt=E.a.div(et||(et=Object(k.a)(["\n    top: 60%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    position: fixed;\n    text-align: center;\n"]))),Ct=function(){var t=Object(S.g)();return Object(T.jsxs)("div",{children:[Object(T.jsx)(Et,{children:"Done!"}),Object(T.jsx)(Tt,{children:Object(T.jsx)(dt.a,{onClick:function(){return t.push("/")},children:"Take me back"})})]})},Lt=function(t){var e=t.loading,n=t.loadingCaption,a=t.showLoading,i=t.hideLoading,r=Object(g.useState)(!1),s=Object(y.a)(r,2),c=s[0],o=s[1],l=Object(g.useState)([]),u=Object(y.a)(l,2),d=u[0],f=u[1],h=Object(g.useState)({}),j=Object(y.a)(h,2),b=j[0],p=j[1],O=Object(g.useState)([]),m=Object(y.a)(O,2),x=m[0],v=m[1],k=Object(g.useState)([]),E=Object(y.a)(k,2),C=E[0],L=E[1],N=Object(g.useState)([]),P=Object(y.a)(N,2),_=P[0],I=P[1],z=Object(g.useState)([]),D=Object(y.a)(z,2),B=D[0],K=D[1],X=Object(g.useState)(""),Y=Object(y.a)(X,2),F=Y[0],J=Y[1],W=Object(g.useState)([]),H=Object(y.a)(W,2),Z=H[0],G=H[1],U=Object(g.useState)([]),V=Object(y.a)(U,2),q=V[0],Q=V[1],R=Object(g.useState)([]),$=Object(y.a)(R,2),tt=$[0],et=$[1];Object(g.useEffect)((function(){fetch("/spotify/is-authenticated").then((function(t){return t.json()})).then((function(t){console.log("authentication status: ".concat(t.status)),o(t.status),i()}))}),[]),Object(g.useEffect)((function(){c&&(fetch("/spotify/playlists").then((function(t){return t.json()})).then((function(t){f(t.playlists.items),console.log(t.playlists.items)})),fetch("/spotify/user-profile").then((function(t){return t.json()})).then((function(t){p(t.user_profile),i()})))}),[c]);var nt=function(t){a("Calculating labels..."),fetch("/spotify/get-labels",{method:"POST",headers:{"Content-Type":"application/json",Model:t},body:JSON.stringify(Z)}).then((function(t){return t.json()})).then((function(t){i();var e=setInterval((function(){fetch("/spotify/task-result",{method:"POST",headers:{"Content-Type":"application/json",taskId:t}}).then((function(t){return t.json()})).then((function(t){console.log(t),"SUCCESS"===t.state&&(et(t.result),clearInterval(e))}))}),3e3)}))},at=Object(S.i)("/playlists/:id"),it=at?d.find((function(t){return t.id===Number(at.params.id)})):null;return e?Object(T.jsx)(st,{loadingCaption:n}):Object(T.jsx)("div",{children:Object(T.jsxs)(S.d,{children:[Object(T.jsx)(S.b,{path:"/playlists/:id",children:Object(T.jsx)(St,{id:it,getLabels:nt,labels:tt,uris:B,showLoading:a,hideLoading:i})}),Object(T.jsx)(S.b,{path:"/login",children:Object(T.jsx)(M,{login:function(){return fetch("/spotify/is-authenticated").then((function(t){return t.json()})).then((function(t){console.log(t.status),t.status||fetch("/spotify/get-auth-url").then((function(t){return t.json()})).then((function(t){o(!0),window.location.replace(t.url)}))}))}})}),Object(T.jsx)(S.b,{path:"/result",children:Object(T.jsx)(Ct,{})}),Object(T.jsx)(S.b,{path:"/",children:Object(T.jsx)(A,{authenticated:c,userInfo:b,playlistList:d,selectPlaylist:function(t){a("Fetching data points..."),v([]),L([]),G([]),Q([]),I([]),K([]),et([]);var e=[];return function t(n){return fetch("/spotify/get-track-ids",{headers:{url:n}}).then((function(t){return t.json()})).then((function(n){if(console.log(n),v((function(t){return[].concat(Object(w.a)(t),Object(w.a)(n.title))})),L((function(t){return[].concat(Object(w.a)(t),Object(w.a)(n.artist))})),G((function(t){return[].concat(Object(w.a)(t),Object(w.a)(n.features))})),I((function(t){return[].concat(Object(w.a)(t),Object(w.a)(n.track_ids))})),K((function(t){return[].concat(Object(w.a)(t),Object(w.a)(n.track_uris))})),e.push(n.features),n.next_url){var a=n.next_url.replace("https://api.spotify.com/v1","");return t(a)}return fetch("/spotify/dimension-reduction-async",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({features:e.flat()})}).then((function(t){return t.json()})).then((function(t){console.log("task id: ".concat(t));var e=setInterval((function(){fetch("/spotify/task-result",{method:"POST",headers:{"Content-Type":"application/json",taskId:t}}).then((function(t){return t.json()})).then((function(t){console.log(t),"SUCCESS"===t.state&&(Q(t.result),clearInterval(e))}))}),3e3)}))}))}("/playlists/".concat(t,"/tracks/?offset=0&limit=100")).then((function(){i()}))},titles:x,artists:C,features:Z,TSNEfeatures:q,ids:_,selectedPlaylist:F,setSelectPlaylistId:function(t){J(t)},getLabels:nt})}),Object(T.jsx)(S.b,{component:kt})]})})},Nt=function(){var t=Object(g.useState)(!0),e=Object(y.a)(t,2),n=e[0],a=e[1],i=Object(g.useState)(""),r=Object(y.a)(i,2),s=r[0],c=r[1];return Object(T.jsx)(v.a,{children:Object(T.jsx)(Lt,{loading:n,loadingCaption:s,showLoading:function(t){a(!0),c(t)},hideLoading:function(){a(!1),c("")}})})};x.a.render(Object(T.jsx)(Nt,{}),document.getElementById("root"))},71:function(t,e,n){},85:function(t,e,n){}},[[107,1,2]]]);
//# sourceMappingURL=main.ee2ef9d5.chunk.js.map